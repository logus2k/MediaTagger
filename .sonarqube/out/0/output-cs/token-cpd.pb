≈
$/home/logus/dev/media_tagger/main.cs
	namespace 	
MediaTagger
 
{ 
class 	
Program
 
{ 
static 
void 
Main 
( 
string 
[  
]  !
args" &
)& '
{ 	
var 
app 
= 
new 

CommandApp $
($ %
)% &
;& '
app 
. 
	Configure 
( 
config  
=>! #
{ 
config 
. 
SetApplicationName )
() *
$str* 8
)8 9
;9 :
config 
. !
SetApplicationVersion ,
(, -
$str- 3
)3 4
;4 5
config 
. 

AddCommand !
<! "
NormalizeCommand" 2
>2 3
(3 4
$str4 ?
)? @
;@ A
config 
. 

AddCommand !
<! "
ReplaceCommand" 0
>0 1
(1 2
$str2 ;
); <
;< =
config 
. 

AddCommand !
<! "
ImportCommand" /
>/ 0
(0 1
$str1 9
)9 :
;: ;
config 
. 

AddCommand !
<! "
DeleteCommand" /
>/ 0
(0 1
$str1 9
)9 :
;: ;
config 
. 

AddCommand !
<! "
ViewCommand" -
>- .
(. /
$str/ 5
)5 6
;6 7
} 
) 
; 
int 
output 
= 
app 
. 
Run  
(  !
args! %
)% &
;& '
}   	
}!! 
}"" É
7/home/logus/dev/media_tagger/src/command/BaseCommand.cs
	namespace 	
MediaTagger
 
{ 
public 

class 
BaseCommand 
: 
Command &
<& '
BaseCommand' 2
.2 3
Settings3 ;
>; <
{		 
public

 
class

 
Settings

 
:

 
CommandSettings

  /
{ 	
public 
MediaDirectory !
OriginalDirectory" 3
=4 5
new6 9
(9 :
): ;
;; <
public 
List 
< 
MediaDirectory &
>& '
ModifiedDirectories( ;
=< =
new> A
(A B
)B C
;C D
private 
string 
? 
_path !
;! "
[ 
CommandArgument 
( 
$num 
, 
$str  (
)( )
]) *
public 
string 
? 
Path 
{ 
get 
{ 
return 
_path  
;  !
} 
set 
{ 
_path 
= 
value !
;! "
if 
( 
Path 
!= 
null  $
&&% '
Path( ,
., -
Length- 3
>4 5
$num6 7
)7 8
{ 
OriginalDirectory )
=* +
DirectoryServices, =
.= >
GetMediaDirectory> O
(O P
PathP T
)T U
;U V
OriginalDirectory   )
.  ) *
Version  * 1
=  2 3
$num  4 5
;  5 6
}!! 
}"" 
}## 
private%% 
bool%% 
_debug%% 
;%%  
['' 
CommandOption'' 
('' 
$str'' $
)''$ %
]''% &
public(( 
bool(( 
Debug(( 
{)) 
get** 
{++ 
return,, 
_debug,, !
;,,! "
}-- 
set.. 
{// 
_debug00 
=00 
value00 "
;00" #
if22 
(22 
_debug22 
)22 
{33 
SettingsDumper44 &
.44& '
Dump44' +
(44+ ,
this44, 0
)440 1
;441 2
}55 
}66 
}77 
}88 	
public:: 
override:: 
int:: 
Execute:: #
(::# $
[::$ %
NotNull::% ,
]::, -
CommandContext::. <
context::= D
,::D E
[::F G
NotNull::G N
]::N O
BaseCommand::P [
.::[ \
Settings::\ d
settings::e m
)::m n
{;; 	
return<< 
$num<< 
;<< 
}== 	
}>> 
}?? ﬂ
9/home/logus/dev/media_tagger/src/command/DeleteCommand.cs
	namespace 	
MediaTagger
 
{ 
public 

class 
DeleteCommand 
:  
Command! (
<( )
DeleteCommand) 6
.6 7
Settings7 ?
>? @
{		 
public

 
sealed

 
class

 
Settings

 $
:

% &
BaseCommand

' 2
.

2 3
Settings

3 ;
{ 	
[ 
CommandOption 
( 
$str %
)% &
]& '
public 
bool 
All 
{ 
get !
;! "
set# &
;& '
}( )
[ 
CommandOption 
( 
$str 1
)1 2
]2 3
public 
bool 
AllExceptCore %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 
CommandOption 
( 
$str ,
), -
]- .
public 
string 
? 
	AllExcept $
{% &
get' *
;* +
set, /
;/ 0
}1 2
[ 
CommandOption 
( 
$str &
)& '
]' (
public 
string 
? 
List 
{  !
get" %
;% &
set' *
;* +
}, -
} 	
public 
override 
int 
Execute #
(# $
[$ %
NotNull% ,
], -
CommandContext. <
context= D
,D E
[F G
NotNullG N
]N O
SettingsP X
settingsY a
)a b
{ 	
return 
$num 
; 
} 	
} 
} ∆
9/home/logus/dev/media_tagger/src/command/ImportCommand.cs
	namespace 	
MediaTagger
 
{ 
public 

class 
ImportCommand 
:  
Command! (
<( )
ImportCommand) 6
.6 7
Settings7 ?
>? @
{		 
public

 
sealed

 
class

 
Settings

 $
:

% &
BaseCommand

' 2
.

2 3
Settings

3 ;
{ 	
[ 
CommandOption 
( 
$str +
)+ ,
], -
public 
bool 
FromFile  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 
CommandOption 
( 
$str 9
)9 :
]: ;
public 
bool  
FromFileAndDirectory ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
} 	
public 
override 
int 
Execute #
(# $
[$ %
NotNull% ,
], -
CommandContext. <
context= D
,D E
[F G
NotNullG N
]N O
SettingsP X
settingsY a
)a b
{ 	
return 
$num 
; 
} 	
} 
} Œ
</home/logus/dev/media_tagger/src/command/NormalizeCommand.cs
	namespace 	
MediaTagger
 
{ 
public 

class 
NormalizeCommand !
:" #
Command$ +
<+ ,
NormalizeCommand, <
.< =
Settings= E
>E F
{		 
public

 
sealed

 
class

 
Settings

 $
:

% &
BaseCommand

' 2
.

2 3
Settings

3 ;
{ 	
[ 
CommandOption 
( 
$str 0
)0 1
]1 2
public 
bool 
RoundBrackets %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 
CommandOption 
( 
$str 1
)1 2
]2 3
public 
bool 
SquareBrackets &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} 	
public 
override 
int 
Execute #
(# $
[$ %
NotNull% ,
], -
CommandContext. <
context= D
,D E
[F G
NotNullG N
]N O
SettingsP X
settingsY a
)a b
{ 	
return 
$num 
; 
} 	
} 
} ¥
:/home/logus/dev/media_tagger/src/command/ReplaceCommand.cs
	namespace 	
MediaTagger
 
{ 
public 

class 
ReplaceCommand 
:  !
Command" )
<) *
ReplaceCommand* 8
.8 9
Settings9 A
>A B
{		 
public

 
sealed

 
class

 
Settings

 $
:

% &
BaseCommand

' 2
.

2 3
Settings

3 ;
{ 	
[ 
CommandOption 
( 
$str )
)) *
]* +
public 
string 
? 
Pattern "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 
CommandOption 
( 
$str .
). /
]/ 0
public 
string 
? 
Substitution '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
[ 
CommandOption 
( 
$str ,
), -
]- .
public 
string 
? 

Dictionary %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 
CommandOption 
( 
$str (
)( )
]) *
public 
string 
? 
Remove !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 	
public 
override 
int 
Execute #
(# $
[$ %
NotNull% ,
], -
CommandContext. <
context= D
,D E
[F G
NotNullG N
]N O
SettingsP X
settingsY a
)a b
{ 	
string 
? 
[ 
] 
text 
= 
Array "
." #
Empty# (
<( )
string) /
>/ 0
(0 1
)1 2
;2 3
if 
( 
settings 
. 
OriginalDirectory *
!=+ -
null. 2
&&3 5
settings6 >
.> ?
OriginalDirectory? P
.P Q
FilesQ V
!=W Y
nullZ ^
)^ _
{   
text!! 
=!! 
settings!! 
.!!  
OriginalDirectory!!  1
.!!1 2
Files!!2 7
.!!7 8
Select!!8 >
(!!> ?
file!!? C
=>!!D F
file!!G K
.!!K L
Name!!L P
)!!P Q
.!!Q R
ToArray!!R Y
(!!Y Z
)!!Z [
;!![ \
}"" 
if$$ 
($$ 
settings$$ 
.$$ 

Dictionary$$ #
!=$$$ &
null$$' +
&&$$, .
settings$$/ 7
.$$7 8

Dictionary$$8 B
.$$B C
Length$$C I
>$$J K
$num$$L M
)$$M N
{%% 
text&& 
[&& 
text&& 
.&& 
Length&&  
]&&  !
=&&" #
settings&&$ ,
.&&, -

Dictionary&&- 7
;&&7 8
}'' 
return;; 
$num;; 
;;; 
}<< 	
}== 
}>> û
7/home/logus/dev/media_tagger/src/command/ViewCommand.cs
	namespace 	
MediaTagger
 
{ 
public		 

class		 
ViewCommand		 
:		 
Command		 &
<		& '
ViewCommand		' 2
.		2 3
Settings		3 ;
>		; <
{

 
public 
sealed 
class 
Settings $
:% &
BaseCommand' 2
.2 3
Settings3 ;
{ 	
[ 
CommandOption 
( 
$str '
)' (
]( )
public 
bool 
Files 
{ 
get  #
;# $
set% (
;( )
}* +
[ 
CommandOption 
( 
$str *
)* +
]+ ,
public 
bool 
Metadata  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 
CommandOption 
( 
$str *
)* +
]+ ,
public 
bool 
Distinct  
{! "
get# &
;& '
set( +
;+ ,
}- .
} 	
public 
override 
int 
Execute #
(# $
[$ %
NotNull% ,
], -
CommandContext. <
context= D
,D E
[F G
NotNullG N
]N O
SettingsP X
settingsY a
)a b
{ 	
if 
( 
settings 
. 
Files 
) 
{ 
ReportViewer 
. 
Files "
(" #
settings# +
.+ ,
OriginalDirectory, =
)= >
;> ?
} 
else 
if 
( 
settings 
. 
Metadata &
)& '
{ 
ReportViewer 
. 
Metadata %
(% &
settings& .
.. /
OriginalDirectory/ @
)@ A
;A B
}   
else!! 
if!! 
(!! 
settings!! 
.!! 
Distinct!! &
)!!& '
{"" 
AnsiConsole## 
.## 
WriteException## *
(##* +
new##+ .#
NotImplementedException##/ F
(##F G
$str##G n
)##n o
)##o p
;##p q
}$$ 
return&& 
$num&& 
;&& 
}'' 	
}(( 
})) ˝
8/home/logus/dev/media_tagger/src/model/MediaDirectory.cs
	namespace 	
MediaTagger
 
{ 
public 

class 
MediaDirectory 
{ 
public 
string 
? 
Path 
{ 
get !
;! "
set# &
;& '
}( )
public 
List 
< 
	MediaFile 
> 
? 
Files  %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public		 
int		 
Version		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
}

 
} è
3/home/logus/dev/media_tagger/src/model/MediaFile.cs
	namespace 	
MediaTagger
 
{ 
public 

class 
	MediaFile 
{ 
public 
int 
Ordinal 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
? 
Name 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
	Extension  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
int 
Hash 
{ 
get 
; 
set "
;" #
}$ %
public		 
MediaFileMetadata		  
?		  !
Metadata		" *
{		+ ,
get		- 0
;		0 1
set		2 5
;		5 6
}		7 8
} 
} ﬂ	
;/home/logus/dev/media_tagger/src/model/MediaFileMetadata.cs
	namespace 	
MediaTagger
 
{ 
public 

class 
MediaFileMetadata "
{ 
public 
string 
? 
Artist 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
? 
Album 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
string		 
?		 
Title		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
public 
string 
? 
TrackNumber "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
? 
Year 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
Genre 
{ 
get "
;" #
set$ '
;' (
}) *
} 
} ™'
=/home/logus/dev/media_tagger/src/utility/DirectoryServices.cs
	namespace 	
MediaTagger
 
{ 
public 

class 
DirectoryServices "
{ 
public 
static 
MediaDirectory $
GetMediaDirectory% 6
(6 7
string7 =
path> B
)B C
{ 	
MediaDirectory 
	directory $
=% &
new' *
(* +
)+ ,
;, -
	directory 
. 
Path 
= 
path !
.! "
Replace" )
() *
$str* -
,- .
$str/ 3
)3 4
.4 5
Replace5 <
(< =
$str= @
,@ A
$strB F
)F G
;G H
if

 
(

 
path

 
!=

 
null

 
&&

 
path

  $
.

$ %
Length

% +
>

, -
$num

. /
)

/ 0
{ 
try 
{ 
string 
[ 
] 

extensions '
=( )
new* -
string. 4
[4 5
]5 6
{6 7
$str7 >
,> ?
$str@ F
,F G
$strH N
,N O
$strP V
,V W
$strX ^
,^ _
$str` f
,f g
$strh n
}n o
;o p
DirectoryInfo !
dirInfo" )
=* +
new, /
(/ 0
path0 4
)4 5
;5 6
List 
< 
FileSystemInfo '
>' (
files) .
=/ 0
new1 4
(4 5
)5 6
;6 7
List 
< 
MediaFileMetadata *
>* +
mediaFileMetadata, =
=> ?
new@ C
(C D
)D E
;E F
if 
( 
dirInfo 
!=  "
null# '
)' (
{ 
files 
= 
dirInfo  '
.' (
GetFileSystemInfos( :
(: ;
); <
. 
Where "
(" #
file# '
=>( *

extensions+ 5
.5 6
Contains6 >
(> ?
file? C
.C D
	ExtensionD M
)M N
)N O
.O P
ToListP V
(V W
)W X
;X Y
} 
List 
< 
	MediaFile "
>" #

mediaFiles$ .
=/ 0
new1 4
(4 5
)5 6
;6 7
int 
trackCounter $
=% &
$num' (
;( )
foreach 
( 
FileSystemInfo +
file, 0
in1 3
files4 9
)9 :
{   
	MediaFile!! !
	mediaFile!!" +
=!!, -
new!!. 1
(!!1 2
)!!2 3
;!!3 4
	mediaFile"" !
.""! "
Ordinal""" )
=""* +
++"", .
trackCounter""/ ;
;""; <
	mediaFile## !
.##! "
Name##" &
=##' (
file##) -
.##- .
Name##. 2
;##2 3
	mediaFile$$ !
.$$! "
	Extension$$" +
=$$, -
file$$. 2
.$$2 3
	Extension$$3 <
;$$< =
	mediaFile%% !
.%%! "
Hash%%" &
=%%' (
file%%) -
.%%- .
GetHashCode%%. 9
(%%9 :
)%%: ;
;%%; <
	mediaFile'' !
.''! "
Metadata''" *
=''+ ,
MetadataManager''- <
.''< =
GetFileMetadata''= L
(''L M
file''M Q
.''Q R
FullName''R Z
)''Z [
;''[ \

mediaFiles)) "
.))" #
Add))# &
())& '
	mediaFile))' 0
)))0 1
;))1 2
}** 
if,, 
(,, 

mediaFiles,, "
.,," #
Count,,# (
>,,) *
$num,,+ ,
),,, -
{-- 
	directory.. !
...! "
Files.." '
=..( )
new..* -
(..- .

mediaFiles... 8
)..8 9
;..9 :
}// 
else00 
{11 
Console22 
.22  
	WriteLine22  )
(22) *
$str22* H
+22I J
path22K O
)22O P
;22P Q
}33 
}44 
catch55 
(55 
	Exception55  
)55  !
{66 
Console77 
.77 
	WriteLine77 %
(77% &
$str77& F
+77G H
path77I M
)77M N
;77N O
}88 
}99 
return;; 
	directory;; 
;;; 
}<<	 

}== 
}>> “
;/home/logus/dev/media_tagger/src/utility/MetadataManager.cs
	namespace 	
MediaTagger
 
{ 
public 

class 
MetadataManager  
{ 
public 
static 
MediaFileMetadata '
GetFileMetadata( 7
(7 8
string8 >
path? C
)C D
{		 	
MediaFileMetadata

 
mediaFileMetadata

 /
=

0 1
new

2 5
(

5 6
)

6 7
;

7 8
if 
( 
! 
string 
. 
IsNullOrEmpty %
(% &
path& *
)* +
)+ ,
{ 
Track 
track 
= 
new !
(! "
path" &
)& '
;' (
mediaFileMetadata !
.! "
Artist" (
=) *
track+ 0
.0 1
Artist1 7
;7 8
mediaFileMetadata !
.! "
Album" '
=( )
track* /
./ 0
Album0 5
;5 6
mediaFileMetadata !
.! "
Title" '
=( )
track* /
./ 0
Title0 5
;5 6
mediaFileMetadata !
.! "
TrackNumber" -
=. /
track0 5
.5 6
TrackNumber6 A
.A B
ToStringB J
(J K
)K L
;L M
mediaFileMetadata !
.! "
Year" &
=' (
track) .
.. /
Year/ 3
.3 4
ToString4 <
(< =
)= >
;> ?
mediaFileMetadata !
.! "
Genre" '
=( )
track* /
./ 0
Genre0 5
;5 6
} 
return 
mediaFileMetadata $
;$ %
} 	
} 
} â
7/home/logus/dev/media_tagger/src/utility/ProgressBar.cs
	namespace 	
MediaTagger
 
{ 
static 

class 
ProgressBar 
{ 
const 
char 
_block 
= 
$char 
;  
const 
string 
_back 
= 
$str A
;A B
const		 
string		 
_twirl		 
=		 
$str		 %
;		% &
public

 
static

 
void

 
WriteProgressBar

 +
(

+ ,
int

, /
percent

0 7
,

7 8
bool

9 =
update

> D
=

E F
false

G L
)

L M
{ 	
if 
( 
update 
) 
Console 
. 
Write 
( 
_back #
)# $
;$ %
Console 
. 
Write 
( 
$str 
) 
; 
var 
p 
= 
( 
int 
) 
( 
( 
percent "
/# $
$num% (
)( )
+* +
$num, /
)/ 0
;0 1
for 
( 
var 
i 
= 
$num 
; 
i 
< 
$num  "
;" #
++$ &
i& '
)' (
{ 
if 
( 
i 
>= 
p 
) 
Console 
. 
Write !
(! "
$char" %
)% &
;& '
else 
Console 
. 
Write !
(! "
_block" (
)( )
;) *
} 
Console 
. 
Write 
( 
$str (
,( )
percent* 1
)1 2
;2 3
} 	
public 
static 
void 
WriteProgress (
(( )
int) ,
progress- 5
,5 6
bool7 ;
update< B
=C D
falseE J
)J K
{ 	
if 
( 
update 
) 
Console 
. 
Write 
( 
$str "
)" #
;# $
Console 
. 
Write 
( 
_twirl  
[  !
progress! )
%* +
_twirl, 2
.2 3
Length3 9
]9 :
): ;
;; <
} 	
} 
}   ¿
7/home/logus/dev/media_tagger/src/utility/RegExEngine.cs
	namespace 	
MediaTagger
 
{ 
public 

class 
RegExEngine 
{ 
public 
static 
string 
Replace $
($ %
string% +
text, 0
,0 1
string2 8
?8 9
pattern: A
,A B
stringC I
?I J

substituteK U
)U V
{ 	
string		 
output		 
=		 
string		 "
.		" #
Empty		# (
;		( )
if 
( 
pattern 
!= 
null 
)  
{ 
Regex 
regex 
= 
new !
(! "
pattern" )
,) *
RegexOptions+ 7
.7 8
Compiled8 @
|A B
RegexOptionsC O
.O P
	MultilineP Y
|Z [
RegexOptions\ h
.h i

IgnoreCasei s
)s t
;t u
MatchCollection 
matches  '
=( )
regex* /
./ 0
Matches0 7
(7 8
text8 <
)< =
;= >
string 
result 
; 
foreach 
( 
Match 
match $
in% '
matches( /
)/ 0
{ 
if 
( 

substitute "
!=# %
null& *
)* +
{ 
result 
=  
match! &
.& '
Result' -
(- .

substitute. 8
)8 9
;9 :
} 
else 
{ 
result 
=  
match! &
.& '
Value' ,
;, -
} 
output   
+=   
result   $
;  $ %
}!! 
}"" 
output$$ 
=$$ 
output$$ 
.$$ 
Replace$$ #
($$# $
$str$$$ (
,$$( )
Environment$$* 5
.$$5 6
NewLine$$6 =
)$$= >
;$$> ?
return&& 
output&& 
;&& 
}'' 	
}(( 
})) £π
8/home/logus/dev/media_tagger/src/utility/ReportViewer.cs
	namespace 	
MediaTagger
 
{ 
public 

class 
ReportViewer 
{ 
public 
static 
void 
Files  
(  !
MediaDirectory! /
	directory0 9
)9 :
{		 	
TablesWidth

 
tablesWidth

 #
=

$ %
SetTablesWidth

& 4
(

4 5

ReportView

5 ?
.

? @
File

@ D
,

D E
	directory

F O
)

O P
;

P Q
Table 
	mainTable 
= 
TableSectionHeader 0
(0 1
	directory1 :
,: ;
tablesWidth< G
.G H
	MainTableH Q
)Q R
;R S
if 
( 
	directory 
. 
Files 
!=  "
null# '
)' (
{ 
string 
propertyNameColor (
=) *
$str+ 6
;6 7
string 
propertyValueColor )
=* +
$str, 4
;4 5
Table 

filesTable  
=! "
new# &
(& '
)' (
;( )

filesTable 
. 
MinimalBorder (
(( )
)) *
;* +

filesTable 
. 
HideFooters &
(& '
)' (
;( )

filesTable 
. 
BorderColor &
(& '
Color' ,
., -
	DarkGreen- 6
)6 7
;7 8
TableColumn 
propertiesColumn ,
=- .
new/ 2
(2 3
$str3 6
+7 8
propertyNameColor9 J
+K L
$strM T
)T U
;U V
propertiesColumn  
.  !
RightAligned! -
(- .
). /
;/ 0

filesTable 
. 
	AddColumn $
($ %
propertiesColumn% 5
)5 6
;6 7
TableColumn 
valuesColumn (
=) *
new+ .
(. /
$str/ J
)J K
;K L
valuesColumn 
. 
LeftAligned (
(( )
)) *
;* +
valuesColumn 
. 
Width "
(" #
tablesWidth# .
.. /
	FileTable/ 8
)8 9
;9 :

filesTable 
. 
	AddColumn $
($ %
valuesColumn% 1
)1 2
;2 3
string!! 
name!! 
=!! 
$str!!  
;!!  !
foreach## 
(## 
	MediaFile## !
file##" &
in##' )
	directory##* 3
.##3 4
Files##4 9
)##9 :
{$$ 
if%% 
(%% 
file%% 
.%% 
Name%% !
!=%%" $
null%%% )
)%%) *
{&& 
name'' 
='' 
file'' #
.''# $
Name''$ (
.''( )
Replace'') 0
(''0 1
$str''1 4
,''4 5
$str''6 :
)'': ;
.''; <
Replace''< C
(''C D
$str''D G
,''G H
$str''I M
)''M N
;''N O
}(( 

filesTable** 
.** 
AddRow** %
(**% &
$str**& )
+*** +
propertyNameColor**, =
+**> ?
$str**@ C
+**D E
file**F J
.**J K
Ordinal**K R
.**R S
ToString**S [
(**[ \
)**\ ]
+**^ _
$str**` e
,**e f
$str**g j
+**k l
propertyValueColor**m 
+
**Ä Å
$str
**Ç Ö
+
**Ü á
name
**à å
+
**ç é
$str
**è î
)
**î ï
;
**ï ñ
}++ 
	mainTable-- 
.-- 
AddRow--  
(--  !

filesTable--! +
)--+ ,
;--, -
}.. 
AnsiConsole00 
.00 
Write00 
(00 
	mainTable00 '
)00' (
;00( )
}11 	
public33 
static33 
void33 
Metadata33 #
(33# $
MediaDirectory33$ 2
	directory333 <
)33< =
{44 	
TablesWidth55 
tablesWidth55 #
=55$ %
SetTablesWidth55& 4
(554 5

ReportView555 ?
.55? @
Metadata55@ H
,55H I
	directory55J S
)55S T
;55T U
Table66 
	mainTable66 
=66 
TableSectionHeader66 0
(660 1
	directory661 :
,66: ;
tablesWidth66< G
.66G H
	MainTable66H Q
)66Q R
;66R S
if88 
(88 
	directory88 
.88 
Files88 
!=88  "
null88# '
)88' (
{99 
int;; !
propertiesColumnWidth;; )
=;;* +
$num;;, -
;;;- .
string<< #
propertyNameHeaderColor<< .
=<</ 0
$str<<1 <
;<<< =
string== $
propertyValueHeaderColor== /
===0 1
$str==2 C
;==C D
string>> 
propertyNameColor>> (
=>>) *
$str>>+ <
;>>< =
string?? 
propertyValueColor?? )
=??* +
$str??, 4
;??4 5
foreachAA 
(AA 
	MediaFileAA !
fileAA" &
inAA' )
	directoryAA* 3
.AA3 4
FilesAA4 9
)AA9 :
{BB 
TableCC 

filesTableCC $
=CC% &
newCC' *
(CC* +
)CC+ ,
;CC, -

filesTableDD 
.DD 
MinimalBorderDD ,
(DD, -
)DD- .
;DD. /

filesTableEE 
.EE 
HideFootersEE *
(EE* +
)EE+ ,
;EE, -

filesTableFF 
.FF 
BorderColorFF *
(FF* +
ColorFF+ 0
.FF0 1
	DarkGreenFF1 :
)FF: ;
;FF; <
stringHH 
nameHH 
=HH  !
$strHH" $
;HH$ %
ifJJ 
(JJ 
fileJJ 
.JJ 
NameJJ !
!=JJ" $
nullJJ% )
)JJ) *
{KK 
nameLL 
=LL 
fileLL #
.LL# $
NameLL$ (
.LL( )
ReplaceLL) 0
(LL0 1
$strLL1 4
,LL4 5
$strLL6 :
)LL: ;
.LL; <
ReplaceLL< C
(LLC D
$strLLD G
,LLG H
$strLLI M
)LLM N
;LLN O
}MM 
TableColumnOO 
propertiesColumnOO  0
=OO1 2
newOO3 6
(OO6 7
$strOO7 :
+OO; <#
propertyNameHeaderColorOO= T
+OOU V
$strOOW [
+OO\ ]
fileOO^ b
.OOb c
OrdinalOOc j
.OOj k
ToStringOOk s
(OOs t
)OOt u
+OOv w
$strOOx }
)OO} ~
;OO~ 
propertiesColumnPP $
.PP$ %
LeftAlignedPP% 0
(PP0 1
)PP1 2
;PP2 3
propertiesColumnQQ $
.QQ$ %
WidthQQ% *
(QQ* +!
propertiesColumnWidthQQ+ @
)QQ@ A
;QQA B

filesTableRR 
.RR 
	AddColumnRR (
(RR( )
propertiesColumnRR) 9
)RR9 :
;RR: ;
TableColumnTT 
valuesColumnTT  ,
=TT- .
newTT/ 2
(TT2 3
$strTT3 6
+TT7 8$
propertyValueHeaderColorTT9 Q
+TTR S
$strTTT W
+TTX Y
nameTTZ ^
+TT_ `
$strTTa f
)TTf g
;TTg h
valuesColumnUU  
.UU  !
LeftAlignedUU! ,
(UU, -
)UU- .
;UU. /
valuesColumnVV  
.VV  !
WidthVV! &
(VV& '
tablesWidthVV' 2
.VV2 3
	FileTableVV3 <
-VV= >!
propertiesColumnWidthVV? T
)VVT U
;VVU V

filesTableWW 
.WW 
	AddColumnWW (
(WW( )
valuesColumnWW) 5
)WW5 6
;WW6 7
ifYY 
(YY 
fileYY 
.YY 
MetadataYY %
!=YY& (
nullYY) -
)YY- .
{ZZ 
if[[ 
([[ 
file[[  
.[[  !
Metadata[[! )
.[[) *
Title[[* /
!=[[0 2
null[[3 7
)[[7 8
{\\ 

filesTable]] &
.]]& '
AddRow]]' -
(]]- .
$str]]. 1
+]]2 3
propertyNameColor]]4 E
+]]F G
$str]]H V
,]]V W
$str]]X [
+]]\ ]
propertyValueColor]]^ p
+]]q r
$str]]s v
+]]w x
file]]y }
.]]} ~
Metadata	]]~ Ü
.
]]Ü á
Title
]]á å
+
]]ç é
$str
]]è î
)
]]î ï
;
]]ï ñ
}^^ 
else__ 
{`` 

filesTableaa &
.aa& '
AddRowaa' -
(aa- .
$straa. 1
+aa2 3
propertyNameColoraa4 E
+aaF G
$straaH V
,aaV W
$straaX Z
)aaZ [
;aa[ \
}bb 
ifdd 
(dd 
filedd  
.dd  !
Metadatadd! )
.dd) *
TrackNumberdd* 5
!=dd6 8
nulldd9 =
)dd= >
{ee 

filesTableff &
.ff& '
AddRowff' -
(ff- .
$strff. 1
+ff2 3
propertyNameColorff4 E
+ffF G
$strffH V
,ffV W
$strffX [
+ff\ ]
propertyValueColorff^ p
+ffq r
$strffs v
+ffw x
fileffy }
.ff} ~
Metadata	ff~ Ü
.
ffÜ á
TrackNumber
ffá í
+
ffì î
$str
ffï ö
)
ffö õ
;
ffõ ú
}gg 
elsehh 
{ii 

filesTablejj &
.jj& '
AddRowjj' -
(jj- .
$strjj. 1
+jj2 3
propertyNameColorjj4 E
+jjF G
$strjjH V
,jjV W
$strjjX Z
)jjZ [
;jj[ \
}kk 
ifmm 
(mm 
filemm  
.mm  !
Metadatamm! )
.mm) *
Artistmm* 0
!=mm1 3
nullmm4 8
)mm8 9
{nn 

filesTableoo &
.oo& '
AddRowoo' -
(oo- .
$stroo. 1
+oo2 3
propertyNameColoroo4 E
+ooF G
$strooH V
,ooV W
$strooX [
+oo\ ]
propertyValueColoroo^ p
+ooq r
$stroos v
+oow x
fileooy }
.oo} ~
Metadata	oo~ Ü
.
ooÜ á
Artist
ooá ç
+
ooé è
$str
ooê ï
)
ooï ñ
;
ooñ ó
}pp 
elseqq 
{rr 

filesTabless &
.ss& '
AddRowss' -
(ss- .
$strss. 1
+ss2 3
propertyNameColorss4 E
+ssF G
$strssH V
,ssV W
$strssX Z
)ssZ [
;ss[ \
}tt 
ifvv 
(vv 
filevv  
.vv  !
Metadatavv! )
.vv) *
Albumvv* /
!=vv0 2
nullvv3 7
)vv7 8
{ww 

filesTablexx &
.xx& '
AddRowxx' -
(xx- .
$strxx. 1
+xx2 3
propertyNameColorxx4 E
+xxF G
$strxxH V
,xxV W
$strxxX [
+xx\ ]
propertyValueColorxx^ p
+xxq r
$strxxs v
+xxw x
filexxy }
.xx} ~
Metadata	xx~ Ü
.
xxÜ á
Album
xxá å
+
xxç é
$str
xxè î
)
xxî ï
;
xxï ñ
}yy 
elsezz 
{{{ 

filesTable|| &
.||& '
AddRow||' -
(||- .
$str||. 1
+||2 3
propertyNameColor||4 E
+||F G
$str||H V
,||V W
$str||X Z
)||Z [
;||[ \
}}} 
if 
( 
file  
.  !
Metadata! )
.) *
Year* .
!=/ 1
null2 6
)6 7
{
ÄÄ 

filesTable
ÅÅ &
.
ÅÅ& '
AddRow
ÅÅ' -
(
ÅÅ- .
$str
ÅÅ. 1
+
ÅÅ2 3
propertyNameColor
ÅÅ4 E
+
ÅÅF G
$str
ÅÅH V
,
ÅÅV W
$str
ÅÅX [
+
ÅÅ\ ] 
propertyValueColor
ÅÅ^ p
+
ÅÅq r
$str
ÅÅs v
+
ÅÅw x
file
ÅÅy }
.
ÅÅ} ~
MetadataÅÅ~ Ü
.ÅÅÜ á
YearÅÅá ã
+ÅÅå ç
$strÅÅé ì
)ÅÅì î
;ÅÅî ï
}
ÇÇ 
else
ÉÉ 
{
ÑÑ 

filesTable
ÖÖ &
.
ÖÖ& '
AddRow
ÖÖ' -
(
ÖÖ- .
$str
ÖÖ. 1
+
ÖÖ2 3
propertyNameColor
ÖÖ4 E
+
ÖÖF G
$str
ÖÖH V
,
ÖÖV W
$str
ÖÖX Z
)
ÖÖZ [
;
ÖÖ[ \
}
ÜÜ 
if
àà 
(
àà 
file
àà  
.
àà  !
Metadata
àà! )
.
àà) *
Genre
àà* /
!=
àà0 2
null
àà3 7
)
àà7 8
{
ââ 

filesTable
ää &
.
ää& '
AddRow
ää' -
(
ää- .
$str
ää. 1
+
ää2 3
propertyNameColor
ää4 E
+
ääF G
$str
ääH V
,
ääV W
$str
ääX [
+
ää\ ] 
propertyValueColor
ää^ p
+
ääq r
$str
ääs v
+
ääw x
file
ääy }
.
ää} ~
Metadataää~ Ü
.ääÜ á
Genreääá å
+ääç é
$strääè î
)ääî ï
;ääï ñ
}
ãã 
else
åå 
{
çç 

filesTable
éé &
.
éé& '
AddRow
éé' -
(
éé- .
$str
éé. 1
+
éé2 3
propertyNameColor
éé4 E
+
ééF G
$str
ééH V
,
ééV W
$str
ééX Z
)
ééZ [
;
éé[ \
}
èè 
	mainTable
ëë !
.
ëë! "
AddRow
ëë" (
(
ëë( )

filesTable
ëë) 3
)
ëë3 4
;
ëë4 5
}
íí 
}
ìì 
Console
ïï 
.
ïï 
	WriteLine
ïï !
(
ïï! "
$str
ïï" >
,
ïï> ?
tablesWidth
ïï@ K
.
ïïK L
	FileTable
ïïL U
)
ïïU V
;
ïïV W
}
ññ 
AnsiConsole
òò 
.
òò 
Write
òò 
(
òò 
	mainTable
òò '
)
òò' (
;
òò( )
}
ôô 	
private
õõ 
static
õõ 
Table
õõ  
TableSectionHeader
õõ /
(
õõ/ 0
MediaDirectory
õõ0 >
	directory
õõ? H
,
õõH I
int
õõJ M
mainTableWidth
õõN \
)
õõ\ ]
{
úú 	
AnsiConsole
ùù 
.
ùù 
	WriteLine
ùù !
(
ùù! "
Ruler
ùù" '
(
ùù' (
)
ùù( )
)
ùù) *
;
ùù* +
Table
üü 
	mainTable
üü 
=
üü 
new
üü !
(
üü! "
)
üü" #
;
üü# $
	mainTable
†† 
.
†† 
HideHeaders
†† !
(
††! "
)
††" #
;
††# $
	mainTable
°° 
.
°° 
HideFooters
°° !
(
°°! "
)
°°" #
;
°°# $
	mainTable
¢¢ 
.
¢¢ 
NoBorder
¢¢ 
(
¢¢ 
)
¢¢  
;
¢¢  !
	mainTable
§§ 
.
§§ 
	AddColumn
§§ 
(
§§  
new
§§  #
TableColumn
§§$ /
(
§§/ 0
$str
§§0 2
)
§§2 3
)
§§3 4
;
§§4 5
Rule
¶¶ 
topRule
¶¶ 
=
¶¶ 
new
¶¶ 
(
¶¶ 
$str
¶¶ 9
)
¶¶9 :
;
¶¶: ;
topRule
ßß 
.
ßß 
	RuleStyle
ßß 
(
ßß 
$str
ßß )
)
ßß) *
;
ßß* +
topRule
®® 
.
®® 
LeftAligned
®® 
(
®®  
)
®®  !
;
®®! "
	mainTable
™™ 
.
™™ 
AddRow
™™ 
(
™™ 
topRule
™™ $
)
™™$ %
;
™™% &
if
¨¨ 
(
¨¨ 
	directory
¨¨ 
.
¨¨ 
Path
¨¨ 
!=
¨¨ !
null
¨¨" &
)
¨¨& '
{
≠≠ 
	mainTable
ÆÆ 
.
ÆÆ 
AddRow
ÆÆ  
(
ÆÆ  !
$str
ÆÆ! 5
+
ÆÆ6 7
	directory
ÆÆ8 A
.
ÆÆA B
Path
ÆÆB F
+
ÆÆG H
$str
ÆÆI N
)
ÆÆN O
;
ÆÆO P
}
ØØ 
else
∞∞ 
{
±± 
	mainTable
≤≤ 
.
≤≤ 
AddRow
≤≤  
(
≤≤  !
$str
≤≤! Y
)
≤≤Y Z
;
≤≤Z [
}
≥≥ 
Table
µµ 
contextTable
µµ 
=
µµ  
new
µµ! $
(
µµ$ %
)
µµ% &
;
µµ& '
contextTable
∂∂ 
.
∂∂ 
HideHeaders
∂∂ $
(
∂∂$ %
)
∂∂% &
;
∂∂& '
contextTable
∑∑ 
.
∑∑ 
HideFooters
∑∑ $
(
∑∑$ %
)
∑∑% &
;
∑∑& '
contextTable
∏∏ 
.
∏∏ 
NoBorder
∏∏ !
(
∏∏! "
)
∏∏" #
;
∏∏# $
contextTable
∫∫ 
.
∫∫ 
	AddColumn
∫∫ "
(
∫∫" #
$str
∫∫# %
)
∫∫% &
;
∫∫& '
Rule
ºº 
contextRule
ºº 
=
ºº 
new
ºº "
(
ºº" #
$str
ºº# 6
+
ºº7 8
	directory
ºº9 B
.
ººB C
Version
ººC J
+
ººK L
$str
ººM R
)
ººR S
;
ººS T
contextRule
ΩΩ 
.
ΩΩ 
	RuleStyle
ΩΩ !
(
ΩΩ! "
$str
ΩΩ" -
)
ΩΩ- .
;
ΩΩ. /
contextRule
ææ 
.
ææ 
RightAligned
ææ $
(
ææ$ %
)
ææ% &
;
ææ& '
	mainTable
¿¿ 
.
¿¿ 
AddRow
¿¿ 
(
¿¿ 
contextRule
¿¿ (
)
¿¿( )
;
¿¿) *
	mainTable
¬¬ 
.
¬¬ 
Width
¬¬ 
=
¬¬ 
mainTableWidth
¬¬ ,
;
¬¬, -
Console
ƒƒ 
.
ƒƒ 
	WriteLine
ƒƒ 
(
ƒƒ 
$str
ƒƒ 3
,
ƒƒ3 4
mainTableWidth
ƒƒ5 C
)
ƒƒC D
;
ƒƒD E
return
∆∆ 
	mainTable
∆∆ 
;
∆∆ 
}
«« 	
private
…… 
static
…… 
TablesWidth
…… "
SetTablesWidth
……# 1
(
……1 2

ReportView
……2 <

reportView
……= G
,
……G H
MediaDirectory
……I W
	directory
……X a
)
……a b
{
   	
int
œœ 
mainTableMargin
œœ 
=
œœ  !
$num
œœ" #
;
œœ# $
int
–– 
fileTableMargin
–– 
=
––  !
$num
––" #
;
––# $
int
““ 
mainTableWidth
““ 
=
““  
$num
““! "
;
““" #
int
”” 
fileTableWidth
”” 
=
””  
$num
””! "
;
””" #
int
‘‘ #
propertiesColumnWidth
‘‘ %
=
‘‘& '
$num
‘‘( )
;
‘‘) *
if
÷÷ 
(
÷÷ 

reportView
÷÷ 
==
÷÷ 

ReportView
÷÷ (
.
÷÷( )
Metadata
÷÷) 1
)
÷÷1 2
{
◊◊ 
mainTableMargin
ÿÿ 
=
ÿÿ  !
$num
ÿÿ" #
;
ÿÿ# $
fileTableMargin
ŸŸ 
=
ŸŸ  !#
propertiesColumnWidth
ŸŸ" 7
;
ŸŸ7 8
mainTableWidth
€€ 
+=
€€ !
mainTableMargin
€€" 1
;
€€1 2
fileTableWidth
‹‹ 
+=
‹‹ !
fileTableMargin
‹‹" 1
;
‹‹1 2
if
ﬁﬁ 
(
ﬁﬁ 
	directory
ﬁﬁ 
.
ﬁﬁ 
Files
ﬁﬁ #
!=
ﬁﬁ$ &
null
ﬁﬁ' +
)
ﬁﬁ+ ,
{
ﬂﬂ 
foreach
‡‡ 
(
‡‡ 
	MediaFile
‡‡ &
file
‡‡' +
in
‡‡, .
	directory
‡‡/ 8
.
‡‡8 9
Files
‡‡9 >
)
‡‡> ?
{
·· 
if
‚‚ 
(
‚‚ 
file
‚‚  
.
‚‚  !
Name
‚‚! %
!=
‚‚& (
null
‚‚) -
&&
‚‚. 0
(
‚‚1 2
file
‚‚2 6
.
‚‚6 7
Name
‚‚7 ;
.
‚‚; <
Length
‚‚< B
+
‚‚C D
fileTableMargin
‚‚E T
)
‚‚T U
>
‚‚V W
fileTableWidth
‚‚X f
)
‚‚f g
{
„„ 
fileTableWidth
‰‰ *
=
‰‰+ ,
file
‰‰- 1
.
‰‰1 2
Name
‰‰2 6
.
‰‰6 7
Length
‰‰7 =
+
‰‰> ?
fileTableMargin
‰‰@ O
;
‰‰O P
}
ÂÂ 
}
ÊÊ 
}
ÁÁ 
if
ÈÈ 
(
ÈÈ 
	directory
ÈÈ 
.
ÈÈ 
Path
ÈÈ "
!=
ÈÈ# %
null
ÈÈ& *
&&
ÈÈ+ -
	directory
ÈÈ. 7
.
ÈÈ7 8
Path
ÈÈ8 <
.
ÈÈ< =
Length
ÈÈ= C
+
ÈÈD E
mainTableMargin
ÈÈF U
>
ÈÈV W
mainTableWidth
ÈÈX f
)
ÈÈf g
{
ÍÍ 
mainTableWidth
ÎÎ "
=
ÎÎ# $
	directory
ÎÎ% .
.
ÎÎ. /
Path
ÎÎ/ 3
.
ÎÎ3 4
Length
ÎÎ4 :
+
ÎÎ; <
mainTableMargin
ÎÎ= L
;
ÎÎL M
if
ÌÌ 
(
ÌÌ 
mainTableWidth
ÌÌ &
<
ÌÌ' (
fileTableWidth
ÌÌ) 7
)
ÌÌ7 8
{
ÓÓ 
mainTableWidth
ÔÔ &
=
ÔÔ' (
fileTableWidth
ÔÔ) 7
;
ÔÔ7 8
}
 
}
ÒÒ 
}
ÚÚ 
else
ÛÛ 
if
ÛÛ 
(
ÛÛ 

reportView
ÛÛ 
==
ÛÛ  "

ReportView
ÛÛ# -
.
ÛÛ- .
File
ÛÛ. 2
)
ÛÛ2 3
{
ÙÙ 
}
ˆˆ 
return
¯¯ 
new
¯¯ 
(
¯¯ 
mainTableWidth
¯¯ %
,
¯¯% &
fileTableWidth
¯¯' 5
)
¯¯5 6
;
¯¯6 7
}
˘˘ 	
private
˚˚ 
static
˚˚ 
string
˚˚ 
Ruler
˚˚ #
(
˚˚# $
)
˚˚$ %
{
¸¸ 	
return
˝˝ 
$str˛˛ ¶
+˛˛ß ®
Environment
ˇˇ 
.
ˇˇ 
NewLine
ˇˇ 
+
ˇˇ  !
$strÄÄ ≠
+ÄÄÆ Ø
Environment
ÅÅ 
.
ÅÅ 
NewLine
ÅÅ 
+
ÅÅ  !
$strÇÇ ≠
;ÇÇ≠ Æ
}
ÉÉ 	
private
ÖÖ 
record
ÖÖ 
TablesWidth
ÖÖ "
(
ÖÖ" #
int
ÖÖ# &
	MainTable
ÖÖ' 0
,
ÖÖ0 1
int
ÖÖ2 5
	FileTable
ÖÖ6 ?
)
ÖÖ? @
;
ÖÖ@ A
private
áá 
enum
áá 

ReportView
áá 
{
áá  
File
áá  $
,
áá$ %
Metadata
áá& .
}
áá. /
;
áá/ 0
}
àà 
}ââ ⁄
:/home/logus/dev/media_tagger/src/utility/SettingsDumper.cs
	namespace 	
MediaTagger
 
{ 
public 

static 
class 
SettingsDumper &
{ 
public 
static 
void 
Dump 
(  
CommandSettings  /
settings0 8
)8 9
{		 	
var

 
table

 
=

 
new

 
Table

 !
(

! "
)

" #
.

# $
RoundedBorder

$ 1
(

1 2
)

2 3
.

3 4
BorderColor

4 ?
(

? @
Color

@ E
.

E F
	DarkGreen

F O
)

O P
;

P Q
table 
. 
	AddColumn 
( 
$str ,
), -
;- .
table 
. 
	AddColumn 
( 
$str -
)- .
;. /
var 

properties 
= 
settings %
.% &
GetType& -
(- .
). /
./ 0
GetProperties0 =
(= >
)> ?
;? @
foreach 
( 
var 
property !
in" $

properties% /
)/ 0
{ 
var 
value 
= 
property $
.$ %
GetValue% -
(- .
settings. 6
)6 7
? 
. 
ToString 
( 
)  
? 
. 
Replace 
( 
$str !
,! "
$str# '
)' (
? 
. 
Replace 
( 
$str !
,! "
$str# '
)' (
;( )
table 
. 
AddRow 
( 
property 
. 
Name !
,! "
value 
?? 
$str +
)+ ,
;, -
} 
AnsiConsole 
. 
Write 
( 
table #
)# $
;$ %
} 	
} 
} Ù
;/home/logus/dev/media_tagger/src/utility/StringUtilities.cs
	namespace 	
MediaTagger
 
{ 
public 

static 
class 
StringUtilities '
{ 
public 
static 
int 

CountLines $
($ %
this% )
string* 0
text1 5
)5 6
{ 	
int 
count 
= 
$num 
; 
if		 
(		 
!		 
string		 
.		 
IsNullOrEmpty		 %
(		% &
text		& *
)		* +
)		+ ,
{

 
count 
= 
text 
. 
Length #
-$ %
text& *
.* +
Replace+ 2
(2 3
Environment3 >
.> ?
NewLine? F
,F G
stringH N
.N O
EmptyO T
)T U
.U V
LengthV \
;\ ]
if 
( 
! 
text 
[ 
^ 
$num 
] 
. 
Equals $
($ %
Environment% 0
.0 1
NewLine1 8
)8 9
)9 :
{ 
++ 
count 
; 
} 
} 
return 
count 
; 
} 	
public 
static 
string 
StringFromList +
(+ ,
List, 0
<0 1
string1 7
>7 8
list9 =
)= >
{ 	
string 
output 
= 
string "
." #
Empty# (
;( )
Console 
. 
	WriteLine 
( 
$str ,
+- .
list/ 3
.3 4
Count4 9
.9 :
ToString: B
(B C
)C D
)D E
;E F
for 
( 
int 
n 
= 
$num 
; 
n 
< 
list  $
.$ %
Count% *
;* +
n, -
++- /
)/ 0
{ 
output 
+= 
list 
[ 
n  
]  !
;! "
if!! 
(!! 
n!! 
<!! 
list!! 
.!! 
Count!! "
)!!" #
{"" 
output## 
+=## 
Environment## )
.##) *
NewLine##* 1
;##1 2
}$$ 
}%% 
return'' 
output'' 
;'' 
}(( 	
public** 
static** 
List** 
<** 
string** !
>**! "
ListFromString**# 1
(**1 2
string**2 8
text**9 =
)**= >
{++ 	
return,, 
text,, 
.,, 
Split,, 
(,, 
Environment,, )
.,,) *
NewLine,,* 1
),,1 2
.,,2 3
ToList,,3 9
(,,9 :
),,: ;
;,,; <
}-- 	
}.. 
}// 